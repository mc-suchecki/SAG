TODO add the Scala code for agents here